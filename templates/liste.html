<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste des Fichiers</title>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        {% include 'header.html' %}
        <h1>Fichiers Téléversés</h1>
        <div id="fileList"></div>
    </div>

    <script>
        async function fetchFiles() {
            const response = await fetch('/api/files');
            const files = await response.json();
            const fileList = document.getElementById("fileList");
            fileList.innerHTML = "";

            let currentDate = "";

            files.forEach(file => {
                if (file.date !== currentDate) {
                    // 📌 Ajouter une nouvelle section pour la date
                    currentDate = file.date;
                    const dateHeader = document.createElement("h2");
                    dateHeader.textContent = currentDate;
                    fileList.appendChild(dateHeader);
                }

                // 📌 Ajouter le fichier avec l'heure
                const li = document.createElement("li");
                
                const timeSpan = document.createElement("span");
                timeSpan.classList.add("file-time");
                timeSpan.textContent = file.time; // ⏱️ Affichage de l'heure
                
                const link = document.createElement("a");
                link.href = `/files/${file.timestamp}_${file.name}`;
                link.textContent = file.name;
                link.target = "_blank";

                li.appendChild(timeSpan);
                li.appendChild(link);
                fileList.appendChild(li);
            });
        }

        fetchFiles();
    </script>
</body>
</html>
